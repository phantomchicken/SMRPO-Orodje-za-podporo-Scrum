<div class="container-fluid p-t-md">
    <div class="row">
        <div class="card col-md-4 mt-4">
            <div class="card-body"  >
              <h5 class="card-title">Project details</h5>
              <h6 class="card-subtitle mt-4 mb-2 text-muted">Project name</h6>
              <p class="card-text">{{project.name}}</p>
              <h6 class="card-subtitle mb-2 text-muted ">Project description</h6>
              <p class="card-text text-justify">{{project.description}}</p>
              <h6 class="card-subtitle mt-4 mb-2 text-muted">Scrum master</h6>
              <p class="card-text" [ngClass]="authenticationService.get_current_user()._id == scrum_master_id ? 'font-weight-bold text-success' : ''">{{scrum_master.firstname}} {{scrum_master.lastname}}</p>
              <h6 class="card-subtitle mt-4 mb-2 text-muted">Product owner</h6>
              <p class="card-text" [ngClass]="authenticationService.get_current_user()._id == product_owner_id ? 'font-weight-bold text-warning' : ''">{{product_owner.firstname}} {{product_owner.lastname}}</p>
              <h6 class="card-subtitle mt-4 mb-2 text-muted">Developers</h6>
              <p *ngFor="let developer of developers" class="card-text" [ngClass]="authenticationService.get_current_user()._id == developer._id ? 'font-weight-bold' : ''">{{developer.firstname}} {{developer.lastname}}</p>
          </div>
        </div>
        <div class="col-md-8 mt-4">
            <nav class="m-3">
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <button class="nav-link active" id="nav-backlog-tab" data-bs-toggle="tab" data-bs-target="#nav-backlog"
                        type="button" role="tab" aria-controls="nav-backlog" aria-selected="true" href="#nav-backlog" 
                        data-toggle="tab">Backlog</button>
                    <button class="nav-link" id="nav-sprints-tab" data-bs-toggle="tab" data-bs-target="#nav-sprints"
                        type="button" role="tab" aria-controls="nav-sprints" aria-selected="false" href="#nav-sprints" 
                        data-toggle="tab">Sprints</button>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-backlog" role="tabpanel" aria-labelledby="nav-backlog-tab">
                    <div class="row">
                            <div *ngFor="let story of stories" class="col-md-3 m-4"> <!-- *ngFor -->
                                <div class="card bg-light">
                                    <div class="card-header d-flex justify-content-between">
                                        <div>
                                            <h5 class="card-title">{{story.name}}</h5>
                                        </div>
                                        <div>
                                            <input class="form-check-input" type="checkbox" value="" (change)="checkStory(story._id, $event.target)">
                                        </div>
                                        
                                    </div>
                                  <div class="card-body">
                                    <p class="card-text"><b>Priority: </b>{{story.priority}}</p>
                                    <p class="card-text"><b>Business value: </b>{{story.businessValue}}</p>
                                    <p class="card-text"><b>Story points: </b> {{story.storyPoints}}</p>
                                    <p *ngIf="story.sprint" class="card-text"><b>Sprint: </b> {{story.sprint}}</p>
                                </div>
                              </div>
                            </div>
                    </div>
                    <div class="row mt-4">
                        <div class="d-flex justify-content-center">
                            <mat-form-field *ngIf="checkedStories.length>0" class="mr-4" style="background-color: white;">
                                <mat-label>Add to sprint</mat-label>
                                <mat-select [(ngModel)]="currSprint" panelClass="example-panel-white" >
                                  <mat-option *ngFor="let sprint of sprints" [value]="sprint"> Sprint {{sprint.startDate | date:'dd.MM'}} - {{sprint.endDate | date:'dd.MM'}}</mat-option>
                                </mat-select>
                              </mat-form-field>                              
                           <button *ngIf="checkedStories.length>0" (click)="addStoriesToSprint()" type="button" class="btn btn-success w-25 mr-2">Add stories to sprint</button>
                           <div *ngIf="success" class="alert alert-success alert-dismissible" role="alert">
                            Stories successfully added!
                            <button type="button" class="close" (click)="hide()" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            </div>
                            <div *ngIf="error" class="alert alert-danger alert-dismissible" role="alert">
                                {{error}}
                                <button type="button" class="close" (click)="hide()" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                       
                        </div>
                        <div class="row mt-4">
                            <div class="d-flex justify-content-center">
                                <button *ngIf="!addStoryVisible" (click)="showAddStory()" type="button" class="btn btn-dark w-25">Add story</button>
                                <button *ngIf="addStoryVisible" (click)="hideAddStory()" type="button" class="btn btn-dark w-25">Hide Form</button>
                            </div>
                        </div>
                        
                        <div *ngIf="addStoryVisible">
                            <app-add-story [project]="project._id"></app-add-story>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="nav-sprints" role="tabpanel" aria-labelledby="nav-sprints-tab">
                    <div class="d-flex justify-content-center">
                        <button *ngIf="!addSprintVisible" (click)="showAddSprint()" type="button" class="btn btn-dark w-25">Add sprint</button>
                        <button *ngIf="addSprintVisible" (click)="hideAddSprint()" type="button" class="btn btn-dark w-25">Hide Form</button>
                    </div>
                    <div *ngIf="addSprintVisible">
                        <app-add-sprint [project]="project._id"></app-add-sprint>
                    </div>
                </div>
            </div>
        </div>       
    </div>
</div>
